<?xml version="1.0" encoding="UTF-8"?>


<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.side.mvcshop.purchase.PurchaseDao">

    <resultMap id="purchaseSelectMap" type="com.side.mvcshop.purchase.Purchase">
        <result property="tranNo"         column="tran_no"           jdbcType="INTEGER" />
        <result property="paymentOption"  column="payment_option"    jdbcType="CHAR" />
        <result property="receiverName"   column="receiver_name"     jdbcType="VARCHAR" />
        <result property="receiverPhone"  column="receiver_phone"    jdbcType="VARCHAR" />
        <result property="dlvyAddr"       column="dlvy_addr"         jdbcType="VARCHAR" />
        <result property="dlvyRequest"    column="dlvy_request"      jdbcType="VARCHAR" />
        <result property="tranCode"       column="tran_status_code"  jdbcType="CHAR" />
        <result property="orderDate"      column="order_date"        jdbcType="DATE" />
        <result property="dlvyDate"       column="dlvy_date"         jdbcType="VARCHAR" />
        <association property="purchaseProd" resultMap="productSelectMap" />
        <association property="buyer" resultMap="userSelectMap" />
    </resultMap>

    <resultMap id="userSelectMap" type="com.side.mvcshop.user.User">
        <result property="userId" 			column="user_id" 			jdbcType="VARCHAR"/>
        <result property="userName"			column="user_name" 			jdbcType="VARCHAR" />
        <result property="password" 		column="password" 			jdbcType="VARCHAR" />
        <result property="role" 			column="role" 				jdbcType="VARCHAR" />
        <result property="ssn" 				column="ssn" 				jdbcType="VARCHAR" />
        <result property="phone" 			column="cell_phone" 		jdbcType="VARCHAR" />
        <result property="addr" 			column="addr" 				jdbcType="VARCHAR" />
        <result property="email" 			column="email" 				jdbcType="NUMERIC"  />
        <result property="regDate" 			column="reg_date" 			jdbcType="TIMESTAMP" />
        <result property="addrDetail"		column="addr_detail"		jdbcType="VARCHAR" />
    </resultMap>

    <resultMap id="productSelectMap" type="com.side.mvcshop.product.Product">
        <result property="prodNo" 		column="PROD_NO"			jdbcType="INTEGER" />
        <result property="prodName"		column="PROD_NAME" 			jdbcType="VARCHAR"/>
        <result property="prodDetail" 	column="PROD_DETAIL" 		jdbcType="VARCHAR"/>
        <result property="manuDate"		column="MANUFACTURE_DAY" 	jdbcType="VARCHAR"/>
        <result property="price" 		column="PRICE" 				jdbcType="INTEGER" />
        <result property="fileName"		column="IMAGE_FILE" 		jdbcType="VARCHAR"/>
        <result property="regDate" 		column="REG_DATE" 			jdbcType="TIMESTAMP"/>
    </resultMap>

    <insert id="addPurchase" parameterType="com.side.mvcshop.purchase.Purchase">
        INSERT
        INTO transaction ( prod_no, buyer_id, payment_option, receiver_name, receiver_phone,
                           dlvy_addr, dlvy_request, tran_status_code, order_date, dlvy_date )
        VALUES           ( #{purchaseProd.prodNo}, #{buyer.userId}, #{paymentOption}, #{receiverName}, #{receiverPhone},
                           #{dlvyAddr}, #{dlvyRequest}, #{tranCode}, #{orderDate}, #{dlvyDate} )
    </insert>

</mapper>
